(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{190:function(e,t,a){"use strict";a.d(t,"a",(function(){return Z}));var n=a(0),r=a.n(n),o=a(66),i=a(1),c=a(286),l=a(287),s=a(8),u=a.n(s),m=a(4),d=a(73),h=a(20),p=a(56),f=(a(269),a(257),(0===p.a.apps.length?p.a.initializeApp({apiKey:"AIzaSyAGCk0o2G4sqKjutWcHPf5GO-2qsKKjhWw",authDomain:"signal-clone-71a42.firebaseapp.com",projectId:"signal-clone-71a42",storageBucket:"signal-clone-71a42.appspot.com",messagingSenderId:"927347466627",appId:"1:927347466627:web:0e196bfff62132192b16b6"}):p.a.app()).firestore()),g=p.a.auth(),E=i.a.create({container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff",padding:10},inputContainer:{width:300},button:{width:200,marginTop:10}}),y=function(e){var t=e.navigation,i=e.route;console.log("login screen route:",i);var c=Object(n.useState)(""),l=u()(c,2),s=l[0],p=l[1],f=Object(n.useState)(""),y=u()(f,2),b=y[0],v=y[1];Object(n.useEffect)((function(){return g.onAuthStateChanged((function(e){e&&t.replace("Home")}))}),[]);var C=function(){g.signInWithEmailAndPassword(s,b).catch((function(e){return alert(e)}))};return r.a.createElement(d.a,{behavior:"padding",style:E.container},r.a.createElement(o.a,{style:"light"}),r.a.createElement(h.d,{source:a(259),style:{width:200,height:200,marginBottom:30}}),r.a.createElement(m.a,{style:E.inputContainer},r.a.createElement(h.e,{type:"email",value:s,onChangeText:function(e){return p(e)},placeholder:"Email",autoFocus:!0}),r.a.createElement(h.e,{type:"password",value:b,onChangeText:function(e){return v(e)},placeholder:"Password",secureTextEntry:!0,onSubmitEditing:C})),r.a.createElement(m.a,{style:E.button},r.a.createElement(h.b,{onPress:C,title:"Login"})),r.a.createElement(m.a,{style:E.button},r.a.createElement(h.b,{style:E.button,onPress:function(){return t.navigate("Register")},title:"Register",type:"outline"})),r.a.createElement(m.a,{style:{height:100}}))},b=a(10),v=a.n(b),C=i.a.create({title:{marginBottom:20},container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"white"},inputContainer:{width:300},button:{width:200,marginTop:10}}),O=function(e){var t=e.navigation,a=Object(n.useState)(""),i=u()(a,2),c=i[0],l=i[1],s=Object(n.useState)(""),p=u()(s,2),E=p[0],y=p[1],b=Object(n.useState)(""),O=u()(b,2),w=O[0],S=O[1],j=Object(n.useState)(""),U=u()(j,2),x=U[0],L=U[1];Object(n.useLayoutEffect)((function(){t.setOptions({headerBackTitle:"Back to Login"})}),[t]);return r.a.createElement(d.a,{behavior:"padding",style:C.container},r.a.createElement(o.a,{style:"light"}),r.a.createElement(h.g,{h3:!0,style:C.title},"Create Account"),r.a.createElement(m.a,{style:C.inputContainer},r.a.createElement(h.e,{type:"text",value:c,autoFocus:!0,placeholder:"Full Name",onChangeText:function(e){return l(e)}}),r.a.createElement(h.e,{type:"text",value:E,placeholder:"Email",onChangeText:function(e){return y(e)}}),r.a.createElement(h.e,{type:"text",value:w,placeholder:"Password",secureTextEntry:!0,onChangeText:function(e){return S(e)}}),r.a.createElement(h.e,{type:"text",value:x,placeholder:"Profile Image Url (Optional)",onChangeText:function(e){return L(e)}})),r.a.createElement(m.a,{style:C.button},r.a.createElement(h.b,{title:"Register",onPress:function(){console.log("name",c),console.log("imageURL",x),g.createUserWithEmailAndPassword(E,w).then((function(e){console.log("authUser:",e),e.user.updateProfile({displayName:c,photoURL:x||"https://alpha-tv.net/wp-content/uploads/2021/12/avatar.png"}),function(e){v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(f.collection("users").add({userName:c,userEmail:e.email,uid:e.uid,userImageURL:x||"https://alpha-tv.net/wp-content/uploads/2021/12/avatar.png"}).then((function(){return console.log("created new db user")})).catch((function(e){return alert(e)})));case 2:case"end":return t.stop()}}),null,null,null,Promise)}(e.user)})).catch((function(e){return alert(e.message)}))}})),r.a.createElement(m.a,{style:{height:100}}))},w=a(7),S=a.n(w),j=a(14),U=a(5),x=a(41),L=a(19),R=a(60),k=a(173),N=i.a.create({container:{},listItem:{}}),T=function(e){var t,o,i,c,l=e.id,s=e.chatName,m=e.chatUsers,d=e.enterChat,p=Object(n.useState)([]),g=u()(p,2),E=g[0],y=g[1],b=Object(n.useState)(!1),v=u()(b,2);v[0],v[1];return Object(n.useEffect)((function(){return f.collection("chats").doc(l).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return y(e.docs.map((function(e){return e.data()})))}))}),[]),r.a.createElement(h.f,{style:N.listItem,key:l,onPress:function(){return d(l,s,m)},key:l,bottomDivider:!0},r.a.createElement(h.a,{rounded:!0,source:null!=E&&null!=(t=E[0])&&t.photoURL?{uri:null==E||null==(o=E[0])?void 0:o.photoURL}:a(86)}),r.a.createElement(h.f.Content,null,r.a.createElement(h.f.Title,{style:{fontWeight:"800"}},s),r.a.createElement(h.f.Subtitle,{numberOfLines:1,ellipsizeMode:"tail"},r.a.createElement(j.a,{style:{opacity:.5,marginRight:5}},null==E||null==(i=E[0])?void 0:i.displayName," "),null==E||null==(c=E[0])?void 0:c.message)))};function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){S()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z=i.a.create({container:{height:"100%"},headerLeft:I({},U.a.select({ios:{},android:{},default:{marginLeft:20}})),headerRight:I({flexDirection:"row",justifyContent:"space-between",width:80},U.a.select({ios:{},android:{},default:{marginRight:20}}))}),B=function(e){var t=e.navigation,a=e.route,o=Object(n.useState)([]),i=u()(o,2),c=i[0],l=i[1];console.log("auth:",g);var s=function(){g.signOut().then((function(){t.replace("Login")}))};Object(n.useEffect)((function(){var e;return f.collection("chats").where("chatUsers","array-contains",null==g||null==(e=g.currentUser)?void 0:e.email).onSnapshot((function(e){return l(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[a]),console.log("Chats:",c),Object(n.useLayoutEffect)((function(){t.setOptions({title:"Simple Chat",headerStyle:{backgroundColor:"white"},headerTitleStyle:{color:"black"},headerTintColor:"black",headerLeft:function(){var e,t;return r.a.createElement(m.a,{style:z.headerLeft},r.a.createElement(L.a,{onPress:s,activeOpacity:.5},r.a.createElement(h.a,{rounded:!0,source:{uri:(null==g||null==(e=g.currentUser)?void 0:e.photoURL)||"https://alpha-tv.net/wp-content/uploads/2021/12/avatar.png"}})),r.a.createElement(j.a,{style:{fontSize:10}},null==g||null==(t=g.currentUser)?void 0:t.displayName))},headerRight:function(){return r.a.createElement(m.a,{style:z.headerRight},r.a.createElement(L.a,{activeOpacity:.5},r.a.createElement(k.a,{name:"camerao",size:24,color:"black"})),r.a.createElement(L.a,{onPress:function(){t.navigate("AddChat")},activeOpacity:.5},r.a.createElement(k.a,{name:"edit",size:24,color:"black"})))}})}),[]);var d=function(e,a,n){t.navigate("Chat",{id:e,chatName:a,chatUsers:n})};return r.a.createElement(R.a,{style:z.container},r.a.createElement(x.a,null,c.map((function(e){var t=e.id,a=e.data,n=a.chatName,o=a.chatUsers;return r.a.createElement(T,{key:t,id:t,chatName:n,chatUsers:o,enterChat:d})}))))},D=i.a.create({container:{backgroundColor:"white",padding:30,height:"100%"}}),A=function(e){var t=e.navigation,a=Object(n.useState)(""),o=u()(a,2),i=o[0],c=o[1];Object(n.useLayoutEffect)((function(){t.setOptions({title:"Add New Chat",headerBackTitle:"Chats"},[t])}));var l=function(){return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.awrap(f.collection("chats").add({chatName:i,chatOwner:g.currentUser.email,chatUsers:[g.currentUser.email]}).then((function(){return t.goBack()})).catch((function(e){return alert(e)})));case 2:case"end":return e.stop()}}),null,null,null,Promise)};return r.a.createElement(m.a,{style:D.container},r.a.createElement(m.a,null,r.a.createElement(h.e,{value:i,placeholder:"Enter New Chat Name",onChangeText:function(e){return c(e)},onSubmitEditing:l,leftIcon:r.a.createElement(h.c,{name:"chat",size:24,color:"black"})}),r.a.createElement(h.b,{onPress:l,title:"Create New Chat",disabled:!i})))},W=a(94),F=a(78),J=a(59),K=a(164),V=a(155),G=i.a.create({safeArea:{flex:1,backgroundColor:"white"},container:{flex:1},headerRight:{flexDirection:"row",justifyContent:"space-between",width:80,marginRight:10},headerLeft:{},footer:{flexDirection:"row",alignItems:"center",width:"100%",padding:15},textInput:{flex:1,bottom:0,height:40,marginRight:15,borderColor:"transparent",backgroundColor:"#ECECEC",borderWidth:1,padding:10,color:"grey",borderRadius:30},reciever:{padding:15,backgroundColor:"#ECECEC",alignSelf:"flex-end",borderRadius:20,marginRight:15,marginBottom:20,maxWidth:"80%",position:"relative"},sender:{padding:15,backgroundColor:"#2B68E6",alignSelf:"flex-start",borderRadius:20,margin:15,maxWidth:"80%",position:"relative"},senderName:{left:10,paddingRight:10,fontSize:10,color:"white"},recieverName:{right:10,paddingLeft:10,fontSize:10,color:"black"},recieverText:{color:"black",fontWeight:"500"},senderText:{color:"white",fontWeight:"500",marginLeft:10,marginBottom:15}}),H=function(e){var t=e.navigation,i=e.route,c=Object(n.useState)(""),l=u()(c,2),s=l[0],E=l[1],y=Object(n.useState)([]),b=u()(y,2),v=b[0],C=b[1];console.log("ChatScreen - route params",i.params),console.log("ChatScreen - navigation",t);var O=function(){t.navigate("JoinChat",{id:i.params.id,chatName:i.params.chatName,chatUsers:i.params.chatUsers})};Object(n.useLayoutEffect)((function(){t.setOptions({title:"",headerTitleAlign:"left",headerBackTitleVisible:!1,headerTitle:function(){var e;return r.a.createElement(m.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},r.a.createElement(h.a,{rounded:!0,source:{uri:(null==(e=v[0])?void 0:e.data.photoURL)||g.currentUser.photoURL}}),r.a.createElement(j.a,{style:{color:"white",marginLeft:10,fontWeight:"700"}},i.params.chatName))},headerRight:function(){return r.a.createElement(m.a,{style:G.headerRight},r.a.createElement(L.a,{onPress:O},r.a.createElement(K.a,{name:"user-plus",size:24,color:"white"})),r.a.createElement(L.a,null,r.a.createElement(V.a,{name:"call",size:24,color:"white"})))}})}),[t,v]);var w=function(){F.a.dismiss(),f.collection("chats").doc(i.params.id).collection("messages").add({timestamp:p.a.firestore.FieldValue.serverTimestamp(),message:s,displayName:g.currentUser.displayName,email:g.currentUser.email,photoURL:g.currentUser.photoURL}),E("")};return Object(n.useLayoutEffect)((function(){return f.collection("chats").doc(i.params.id).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return C(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[i]),r.a.createElement(R.a,{style:G.container},r.a.createElement(o.a,{style:"light"}),r.a.createElement(d.a,{behavior:"ios"===U.a.OS?"padding":"height",style:G.container,keyboardVerticalOffset:90},r.a.createElement(J.a,{onPress:F.a.dismiss},r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{contentContainerStyle:{paddingTop:15}},v.map((function(e){var t=e.id,n=e.data;return n.email===g.currentUser.email?r.a.createElement(m.a,{key:t,style:G.reciever},r.a.createElement(h.a,{rounded:!0,containerStyle:{position:"absolute",bottom:-15,right:-5},position:"absolute",bottom:-15,right:-5,size:30,source:n.photoURL?{uri:n.photoURL}:a(86)}),r.a.createElement(j.a,{style:G.recieverText},n.message),r.a.createElement(j.a,{style:G.recieverName},n.displayName||"No Name "+n.email),r.a.createElement(j.a,{style:{fontSize:10}},new Date(1e3*n.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))):r.a.createElement(m.a,{key:t,style:G.sender},r.a.createElement(h.a,{rounded:!0,containerStyle:{position:"absolute",bottom:-15,left:-5},position:"absolute",bottom:-15,left:-5,size:30,source:n.photoURL?{uri:n.photoURL}:a(86)}),r.a.createElement(j.a,{style:G.senderText},n.message),r.a.createElement(j.a,{style:G.senderName},n.displayName||"No Name "+n.email))}))),r.a.createElement(m.a,{style:G.footer},r.a.createElement(W.a,{value:s,onChangeText:function(e){return E(e)},style:G.textInput,placeholder:"Enter Message",onSubmitEditing:w}),r.a.createElement(L.a,{onPress:w,activeOpacity:.5,disabled:!s},r.a.createElement(V.a,{name:"send",size:24,color:"#2B68E6"})))))))},M=i.a.create({container:{},button:{width:40,backgroundColor:"#2C6BED",flex:1,justifyContent:"center",alignItems:"center",borderRadius:50}}),q=function(e){var t=e.route;console.log("JoinChatScreen route: ",t);var o=Object(n.useState)([]),i=u()(o,2),c=i[0],l=i[1];console.log("chatUsers:",c),Object(n.useEffect)((function(){var e;return f.collection("users").where("userEmail","!=",null==g||null==(e=g.currentUser)?void 0:e.email).onSnapshot((function(e){return l(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[t]);return r.a.createElement(R.a,{style:M.container},r.a.createElement(x.a,null,c.map((function(e,n){var o,i;return r.a.createElement(h.f,{style:M.listItem,key:n,bottomDivider:!0},r.a.createElement(h.a,{rounded:!0,source:null!=e&&null!=(o=e.data)&&o.userImageURL?{uri:null==e||null==(i=e.data)?void 0:i.userImageURL}:a(86)}),r.a.createElement(h.f.Content,null,r.a.createElement(h.f.Title,{style:{fontWeight:"800"}},e.data.userName),r.a.createElement(h.f.Subtitle,{numberOfLines:1,ellipsizeMode:"tail"},e.data.userEmail)),t.params.chatUsers.includes(e.data.userEmail)?r.a.createElement(K.a,{name:"users",size:24,color:"#2B68E6",style:{opacity:.3}}):r.a.createElement(L.a,{onPress:function(){return function(e,a){var n="https://signal-clone-71a42.web.app/join/"+t.params.id+"/"+e;return console.log("inviteUrl:",n),f.collection("chats").doc(t.params.id).update({chatUsers:p.a.firestore.FieldValue.arrayUnion(a)}).then((function(){console.log("Document successfully updated!"),alert("User successfully invited!")})).catch((function(e){console.error("Error updating document: ",e)}))}(e.data.uid,e.data.userEmail)}},r.a.createElement(K.a,{name:"user-plus",size:24,color:"#2B68E6"})))}))))},Q=Object(l.a)(),X={headerStyle:{backgroundColor:"#2C6BED"},headerTitleStyle:{color:"#fff"},headerTintColor:"white"},Y={config:{screens:{JoinChat:"join/:id/:chatName"}}};function Z(){return r.a.createElement(c.a,{linking:Y,style:$.container},r.a.createElement(Q.Navigator,{screenOptions:X},r.a.createElement(Q.Screen,{name:"Login",component:y}),r.a.createElement(Q.Screen,{name:"Register",component:O}),r.a.createElement(Q.Screen,{name:"Home",component:B}),r.a.createElement(Q.Screen,{name:"AddChat",component:A}),r.a.createElement(Q.Screen,{name:"Chat",component:H}),r.a.createElement(Q.Screen,{name:"JoinChat",component:q})))}var $=i.a.create({container:{}})},195:function(e,t,a){e.exports=a(266)},259:function(e,t,a){e.exports=a.p+"static/media/logo.349c903c.png"},86:function(e,t,a){e.exports=a.p+"static/media/avatar.74dc8f5e.png"}},[[195,1,2]]]);
//# sourceMappingURL=app.742939ed.chunk.js.map